var M=Object.defineProperty,G=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var O=(t,n,r)=>n in t?M(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,T=(t,n)=>{for(var r in n||(n={}))z.call(n,r)&&O(t,r,n[r]);if(W)for(var r of W(n))K.call(n,r)&&O(t,r,n[r]);return t},L=(t,n)=>G(t,q(n));import{a as Y,j as B,L as F,r as c,N as D,F as k,f as V,b as J,c as Q,G as X,u as Z,d as ee,e as te,g as E,h as ne,R as re,i as se,k as f,l as ae,B as ie}from"./vendor.1a4d59a9.js";const oe=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}};oe();const w=Y.create({baseURL:"https://bonvoyage-app.herokuapp.com/",withCredentials:!0});w.interceptors.request.use(t=>{const n=localStorage.getItem("authToken");return n&&(t.headers.Authorization=`Bearer ${n}`),t});//! Error handling to use in the catch
function R(t){throw t.response.data,t}const b=L(T({},w),{signup(t){return w.post("/api/auth/signup",t).then(n=>n.data).catch(R)},isLoggedIn(t){return w.get("/api/auth/me",{headers:{Authorization:`Bearer ${t}`}}).then(n=>n.data).catch(R)},signin(t){return w.post("/api/auth/signin",t).then(n=>n.data).catch(R)}}),e=B.exports.jsx,s=B.exports.jsxs,x=B.exports.Fragment,le=()=>s("div",{className:"homebody",children:[s("div",{className:"hometext",children:[e("h1",{children:"TRIP APP"}),e("h2",{children:"Explore travel itineraries"}),e("h2",{children:"Search by destination, category or duration"}),e("h2",{children:"Add your own trips and rate others"})]}),s(F,{to:"/trips",children:["START EXPLORING ",e("i",{class:"fa-solid fa-earth-americas"})]})]}),j=c.exports.createContext(),A=()=>c.exports.useContext(j),ce=()=>{const{isLoggedIn:t,removeUser:n}=A();return s("div",{className:"navbar",children:[e(D,{to:"/",children:"Home"}),!t&&s(x,{children:[e(D,{to:"/signin",children:"Sign In"}),e(D,{to:"/signup",children:"Sign Up"})]}),t&&s(x,{children:[e(D,{to:"/profile",children:"Profile"}),e("p",{onClick:n,children:"Logout"})]})]})},de=({searchedString:t,callbackSearch:n})=>e("div",{children:e("input",{className:"search",type:"text",placeholder:"Enter your destination...",value:t,onChange:r=>n(r.target.value)})}),he=["budget","comfortable","luxury","family","adventure","culture","shopping","romantic","party","gastronomic","nature"],ue=({filteredCats:t,callbackFilter:n})=>e("div",{children:e("div",{className:"catfilters",children:he.map(r=>e("div",{children:s("div",{children:[e("input",{type:"checkbox",id:r,name:r,value:r,onChange:o=>n(o.target.value,o.target.checked)}),e("label",{children:r})]})},r))})}),pe=()=>s("div",{children:[e("p",{children:"Filter by duration"}),e("input",{id:"ticketNum",type:"number",name:"ticketNum",value:"0"})]});const me=({trips:t})=>{const[n,r]=c.exports.useState(""),[o,a]=c.exports.useState(t),[i,d]=c.exports.useState([]);if(c.exports.useState([]),!t)return e("div",{children:"Loading"});const[u,h]=c.exports.useState(!1),l=()=>{h(!u)},y=(p,C)=>{d(C?[...i,p]:i.filter(P=>P!==p))};return t.map(p=>{p.categories.map(C=>{console.log(typeof p.categories),console.log(typeof p.filteredCats)})}),c.exports.useEffect(()=>{if(n!==""){const p=t.filter(C=>C.location.toLowerCase().includes(n.toLowerCase()));a(p)}else a(t)},[t,n]),s("div",{className:"tripsbody",children:[s("style",{children:["@import url('https://fonts.googleapis.com/css2?family=Domine:wght@500&display=swap'); @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600&display=swap');"," "]}),e("h1",{children:"All Trips"}),s("div",{className:"searchbar",children:[e(de,{searchedString:n,callbackSearch:r}),e("button",{className:"toggleBtn",onClick:l,children:e("i",{className:"fas fa-filter fa-2x"})})]}),u&&s("div",{className:"filters",children:[e(ue,{filteredCats:i,callbackFilter:y}),e(pe,{})]}),e("p",{className:"instruct",children:"Click on a trip to see the full itinerary"}),e("div",{className:"tripscontainer",children:o.map(p=>s("div",{className:"trip",children:[e(F,{to:p._id,children:e("p",{className:"title",children:p.title})}),e("p",{children:p.description}),s("p",{children:[e("i",{className:"fas fa-map-marker-alt"})," ",p.location]}),e("p",{children:p.categories.join(", ")}),s("p",{children:["Contributor: ",p.author.username]}),e("img",{src:p.image[0],alt:""}),s("p",{className:"daynumber",children:[e("i",{className:"far fa-calendar-alt"})," DAYS: ",p.days.length]})]},p._id))})]})},ge="_container_wr6ca_23",fe="_carousel_wr6ca_31",ve="_item_wr6ca_57",ye="_buttons_wr6ca_95";var _={container:ge,carousel:fe,item:ve,buttons:ye};const be=({trip:t})=>{var a;const n=c.exports.useRef(null),r=i=>{i.preventDefault(),n.current.scrollLeft-=n.current.offsetWidth},o=i=>{i.preventDefault(),n.current.scrollLeft+=n.current.offsetWidth};return console.log("current pic:",n.current),s("div",{children:[e("style",{children:`@import url('https://fonts.googleapis.com/css2?family=Domine:wght@500&family=Montserrat&family=Open+Sans&display=swap" rel="stylesheet');`}),e("div",{className:_.container,children:e("div",{className:_.carousel,ref:n,children:(a=t.image)==null?void 0:a.map((i,d)=>s("div",{className:_.item,children:[e("div",{className:_.image,children:e("img",{src:i,alt:""})}),e("div",{className:_.info,children:e("p",{children:"description"})})]},d))})}),s("div",{className:_.buttons,children:[e("button",{onClick:r,children:e(k,{icon:V})}),e("button",{onClick:o,children:e(k,{icon:J})})]})]})},Se=()=>e(Q,{googleMapsApiKey:"AIzaSyDEaeUiFD9oAnB1LNDiK-GWyDq6zS9HWS4",children:e(X,{mapContainerStyle:{height:"100vh",width:"60%"},zoom:13,center:{lat:48.8528,lng:2.3883}})}),Ce="_detailsBody_1ukx4_1",xe="_numberBlock_1ukx4_23",_e="_containerDetails_1ukx4_53",Ne="_infosBlock_1ukx4_71",ke="_containerWrapper_1ukx4_87",we="_biggerPic_1ukx4_97",Te="_detailsHeader_1ukx4_107";var S={detailsBody:Ce,numberBlock:xe,containerDetails:_e,infosBlock:Ne,containerWrapper:ke,biggerPic:we,detailsHeader:Te};const Le=({favesClick:t,faves:n})=>{const[r,o]=c.exports.useState({}),{id:a}=Z(),{currentUser:i,isLoggedIn:d,storeToken:u}=A();return c.exports.useEffect(()=>{b.get("http://localhost:8000/trips/"+a).then(({data:h})=>{o(h)}).catch(h=>console.log(h))},[a]),e("div",{className:S.detailsBody,children:r.days?s(x,{children:[s("div",{className:S.detailsHeader,children:[e("h1",{children:r.title}),e("h2",{children:r.location}),e("h3",{children:r.description}),s("h3",{children:["Contributed by: ",r.author.username]})]}),e("div",{children:e("img",{className:S.biggerPic,src:r.image[0],alt:""})}),d&&s("div",{className:"tripsbtn",children:[!n.includes(a)&&s("button",{onClick:()=>t(a),children:["Favourite ",e("i",{className:"fa-solid fa-sun"})]}),n.includes(a)&&s("button",{onClick:()=>t(a),children:["Unfavourite"," ",e("i",{className:"fa-solid fa-cloud-showers-heavy"})]})]}),e(F,{to:"/trips",children:e("button",{children:"Back to trips"})}),e("div",{className:S.containerWrapper,children:r.days.map(h=>s("div",{className:S.containerDetails,children:[e("div",{className:S.numberBlock,classkey:h._id,children:e("p",{children:h.number})}),e("div",{className:S.infosBlock,children:h.activities.map(l=>s("div",{children:[e("p",{children:e("b",{children:l.title})}),s("p",{children:[s("b",{children:[e(k,{icon:ee}),":"," "]}),l.address]}),s("p",{children:[s("b",{children:[e(k,{icon:te}),":"," "]}),l.description]}),e("br",{})]},l._id))})]},h._id))}),e(be,{trip:r}),e(Se,{})]}):e("p",{children:"Sorry, no trip yet!"})})},H=t=>{const[n,r]=c.exports.useState(t);return[n,a=>{r(L(T({},n),{[a.target.name]:a.target.value}))}]},Fe=()=>{const[t,n]=H({email:"",password:""}),[r,o]=c.exports.useState(null),a=E(),{authenticateUser:i,storeToken:d}=A(),u=h=>{h.preventDefault(),b.signin(t).then(l=>{console.log("this is signin front:",l),d(l.authToken),i(),a("/")}).catch(l=>{console.error(l),o(l.response)})};return s(x,{children:[r&&e("h3",{className:"error",children:r.message}),s("form",{className:"authform",onSubmit:u,children:[e("h2",{children:"Sign in"}),e("label",{htmlFor:"email",children:"Email"}),e("input",{type:"email",id:"email",name:"email",onChange:n,value:t.email}),e("label",{htmlFor:"password",children:"Password"}),e("input",{type:"password",id:"password",name:"password",onChange:n,value:t.password}),e("button",{children:"Sign in"})]})]})};const De=()=>s("div",{className:"signinbody",children:[s("style",{children:["@import url('https://fonts.googleapis.com/css2?family=Domine:wght@500&display=swap'); @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600&display=swap');"," "]}),e(Fe,{})]}),Ae=()=>{const[t,n]=H({name:"",username:"",email:"",password:""}),[r,o]=c.exports.useState(null),a=E(),i=d=>{d.preventDefault(),b.signup(t).then(u=>{console.log("this is signup front:",u),a("/signin")}).catch(u=>{o(u.response.data)})};return s(x,{children:[r&&e("h3",{className:"error",children:r.message}),s("form",{className:"authform",onSubmit:i,children:[e("h2",{children:"Sign up"}),e("label",{htmlFor:"name",children:"Name"}),e("input",{onChange:n,value:t.name,type:"text",id:"name",name:"name"}),e("label",{htmlFor:"username",children:"Username"}),e("input",{onChange:n,value:t.username,type:"text",id:"username",name:"username"}),e("label",{htmlFor:"email",children:"Email"}),e("input",{onChange:n,value:t.email,type:"email",id:"email",name:"email"}),e("label",{htmlFor:"password",children:"Password"}),e("input",{onChange:n,value:t.password,type:"password",id:"password",name:"password"}),e("button",{children:"Create account"})]})]})},Ie=()=>s("div",{className:"signupbody",children:[s("style",{children:["@import url('https://fonts.googleapis.com/css2?family=Domine:wght@500&display=swap'); @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600&display=swap');"," "]}),e(Ae,{})]}),Pe="_profileWrapper_tlb6c_1",Be="_profileSection_tlb6c_15",Ee="_addTripContainer_tlb6c_31",Re="_addTitle_tlb6c_57",Ue="_addSubtitle_tlb6c_75",We="_favoritesProfile_tlb6c_97",Oe="_plusIcon_tlb6c_107";var v={profileWrapper:Pe,profileSection:Be,addTripContainer:Ee,addTitle:Re,addSubtitle:Ue,favoritesProfile:We,plusIcon:Oe};const je=()=>s("div",{className:v.profileWrapper,children:[e("div",{children:e("h1",{children:"Welcome to your Travel Board!"})}),s("div",{className:v.profileSection,children:[s("section",{className:v.addTripContainer,children:[e("h2",{className:v.addTitle,children:"How about let others discover your trips?"}),s("div",{children:[e("p",{className:v.addSubtitle,children:"Create a new Trip:"}),s(F,{to:"/profile/create",children:[" ",e(k,{icon:ne,className:v.plusIcon})]})]})]}),s("section",{className:v.favoritesProfile,children:[e("h2",{children:"Don't forget your favorite itineraries!"}),e("div",{children:"Check favorites here"})]}),s("section",{className:v.favoritesProfile,children:[e("h2",{children:"Your added trips"}),e("div",{children:"Check favorites here"})]})]})]});let I;const He=(t,n)=>{let r=document.createElement("script");r.type="text/javascript",r.readyState?r.onreadystatechange=function(){(r.readyState==="loaded"||r.readyState==="complete")&&(r.onreadystatechange=null,n())}:r.onload=()=>n(),r.src=t,document.getElementsByTagName("head")[0].appendChild(r)};function $e(t,n){I=new window.google.maps.places.Autocomplete(n.current),I.setFields(["address_components","formatted_address"]),I.addListener("place_changed",()=>Me(t))}async function Me(t){const n=I.getPlace(),r=n.formatted_address;t(r),console.log(n)}function Ge({address:t,activityChange:n,activityNumber:r}){const[o,a]=c.exports.useState(t),i=c.exports.useRef(null);c.exports.useEffect(()=>{He(`https://maps.googleapis.com/maps/api/js?key=${{}.GOOGLE_API_KEY}&libraries=places`,()=>$e(a,i))},[]);const d=u=>{a(u.target.value),n(u)};return s("div",{className:"search-location-input",children:[e("label",{htmlFor:"address-"+r,children:"Address"}),e("input",{type:"text",name:"address",id:"address-"+r,ref:i,onChange:d,placeholder:"",value:t})]})}const qe=({activity:t,setDays:n,activityNumber:r,dayNumber:o})=>{const a=i=>{n(d=>{const u=[...d];return u[o][r]=L(T({},u[o][r]),{[i.target.name]:i.target.value}),u})};return s(x,{children:[s("div",{children:[e("label",{htmlFor:"activityTitle-"+r,children:"Title"}),e("input",{type:"text",name:"title",id:`activityTitle-${r}`,value:t.title,onChange:a})]}),e("div",{children:e(Ge,{address:t.address,activityNumber:r,activityChange:a})}),s("div",{children:[e("label",{htmlFor:"activityDescription-"+r,children:"Description"}),e("input",{type:"text",name:"description",value:t.description,onChange:a})]})]})},ze=({dayNumber:t,activities:n,setDays:r})=>{console.log("It's a brand new day !");const o=a=>{a.preventDefault(),r(i=>{const d=[...i];return d[t]=[...d[t],{title:"",address:"",description:""}],d})};return console.log("Activities :",n),n?s("div",{children:[s("h2",{children:["Day n\xB0 ",t+1]}),e("button",{onClick:o,children:"Add an activity"}),s("p",{children:["Number of activities ",n.length," "]}),n.map((a,i)=>e(qe,{activity:a,dayNumber:t,activityNumber:i,setDays:r},i))]}):null},$=()=>{const[t,n]=c.exports.useState(""),[r,o]=c.exports.useState([]),[a,i]=c.exports.useState(""),[d,u]=c.exports.useState(""),h=c.exports.useRef(),[l,y]=c.exports.useState([[{title:"",address:"",description:""}]]),p=["budget","comfortable","luxury","family","adventure","culture","shopping","romantic","party","gastronomic","nature"],C=g=>{g.preventDefault(),y(m=>[...m,[{title:"",address:"",description:""}]])},P=g=>{if(g.target.checked)o([...r,g.target.value]);else{const m=r.filter(N=>N!==g.target.value);o(m)}},U=g=>{g.preventDefault();const m=new FormData;m.append("title",t),m.append("categories",r),m.append("location",a),m.append("description",d),m.append("image",h.current.files),m.append("days",JSON.stringify(l)),console.log("FORM DATA ------>",m),console.log("---> What are you 'days' ?",l),b.post("/trips",m).then(N=>console.log("RES apiHandler",N)).catch(N=>console.log(N))};return console.log("------- CURRENT STATE OF TRIP IS -----"),s("div",{children:[e("h2",{children:"ADD A NEW TRIP"}),s("form",{className:"tripform",onSubmit:U,children:[s("div",{children:[e("label",{htmlFor:"title",children:" Title "}),e("input",{type:"text",id:"title",value:t,onChange:g=>n(g.target.value)})]}),s("div",{children:[e("label",{htmlFor:"location",children:" Location "}),e("input",{type:"text",id:"location",value:a,onChange:g=>i(g.target.value)})]}),e("div",{children:p.map((g,m)=>s(re.Fragment,{children:[e("input",{type:"checkbox",id:`category-${g}-${m}`,value:g,onChange:P}),e("label",{htmlFor:`category-${g}-${m}`,children:g})]},m))}),s("div",{children:[e("label",{htmlFor:"description",children:" Description "}),e("input",{type:"text",id:"description",value:d,onChange:g=>u(g.target.value)})]}),e("input",{ref:h,name:"image",type:"file"}),e("button",{onClick:C,children:"Add a day"}),s("p",{children:["Number of days ",l==null?void 0:l.length," "]}),l.map((g,m)=>e(ze,{activities:l[m],setDays:y,dayNumber:m},m)),e("button",{onClick:U,children:"Good"})]})]})};function Ke(){const[t,n]=c.exports.useState([]),[r,o]=c.exports.useState([]),{currentUser:a,isLoggedIn:i,storeToken:d}=A();return c.exports.useEffect(()=>{b.get("/trips").then(({data:h})=>{n(h)}).catch(h=>console.error(h))},[]),c.exports.useEffect(()=>{a&&o(a.favourites)},[i]),s("div",{className:"App",children:[e(ce,{}),s(se,{children:[e(f,{path:"/",element:e(le,{trips:t})}),e(f,{path:"/trips",element:e(me,{trips:t})}),e(f,{path:"/trips/:id",element:e(Le,{trips:t,favesClick:h=>{b.patch("/users/favourites/"+h).then(({data:l})=>{o(l.favourites)}).catch(l=>console.error(l))},faves:r})}),e(f,{path:"/signup",element:e(Ie,{})}),e(f,{path:"/signin",element:e(De,{})}),e(f,{path:"/profile",element:e(je,{})}),e(f,{path:"/profile/create",element:e($,{})}),e(f,{path:"/profile/:id/update",element:e($,{})})]})]})}const Ye=({children:t})=>{const n=E(),[r,o]=c.exports.useState({currentUser:null,isLoading:!0,isLoggedIn:!1});c.exports.useEffect(()=>{a()},[]);const a=()=>{const l=localStorage.getItem("authToken");l?b.isLoggedIn(l).then(y=>{o({currentUser:y,isLoading:!1,isLoggedIn:!0})}).catch(y=>{o({currentUser:null,isLoading:!1,isLoggedIn:!1})}):o({currentUser:null,isLoading:!1,isLoggedIn:!1})},i=()=>{d(),a(),n("/")},d=()=>{localStorage.removeItem("authToken")},u=l=>{localStorage.setItem("authToken",l),a()},h={currentUser:r.currentUser,isLoading:r.isLoading,isLoggedIn:r.isLoggedIn,removeUser:i,storeToken:u,authenticateUser:a};return e(j.Provider,{value:h,children:t})};ae.render(e(ie,{children:e(Ye,{children:e(Ke,{})})}),document.getElementById("root"));
