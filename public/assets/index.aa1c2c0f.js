var V=Object.defineProperty,J=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var O=(r,t,n)=>t in r?V(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n,T=(r,t)=>{for(var n in t||(t={}))X.call(t,n)&&O(r,n,t[n]);if(j)for(var n of j(t))Z.call(t,n)&&O(r,n,t[n]);return r},I=(r,t)=>J(r,Q(t));import{a as ee,j as $,r as c,N as A,F as b,f as te,L as B,b as R,c as M,d as ne,e as re,g as ae,h as se,G as oe,M as ie,u as q,i as le,k as ce,l as de,m as E,n as ue,R as z,o as pe,p as k,q as he,B as me}from"./vendor.9a0a68ef.js";const ge=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}};ge();const U=ee.create({baseURL:"https://bonvoyage-app.herokuapp.com",withCredentials:!0});U.interceptors.request.use(r=>{const t=localStorage.getItem("authToken");return t&&(r.headers.Authorization=`Bearer ${t}`),r});//! Error handling to use in the catch
function W(r){throw r.response.data,r}const _=I(T({},U),{signup(r){return U.post("/api/auth/signup",r).then(t=>t.data).catch(W)},isLoggedIn(r){return U.get("/api/auth/me",{headers:{Authorization:`Bearer ${r}`}}).then(t=>t.data).catch(W)},signin(r){return U.post("/api/auth/signin",r).then(t=>t.data).catch(W)}}),e=$.exports.jsx,s=$.exports.jsxs,D=$.exports.Fragment,fe=()=>e("div",{className:"homebody",children:s("div",{className:"hometext",children:[e("h2",{children:"Explore travel itineraries by place, theme or duration"}),e("h2",{children:"Add your own trips and rate others"})]})}),Y=c.exports.createContext(),P=()=>c.exports.useContext(Y),ve=()=>{const{isLoggedIn:r,removeUser:t}=P();return s("div",{className:"navbar",children:[e(A,{to:"/",children:"Home"}),e(A,{to:"/trips",children:"Trips"}),e("a",{href:"/",children:e("h1",{className:"logo",children:"bon voyage"})}),!r&&s(D,{children:[e(A,{to:"/signin",children:"Sign in"}),e(A,{to:"/signup",children:"Sign up"})]}),r&&s(D,{children:[e(A,{to:"/profile",children:"Profile"}),e("p",{onClick:t,children:"Log out"})]})]})},ye=({searchedString:r,callbackSearch:t})=>e("div",{children:e("input",{className:"search",type:"text",placeholder:"Enter your destination...",value:r,onChange:n=>t(n.target.value)})}),be=["budget","comfortable","luxury","family","adventure","culture","shopping","romantic","party","gastronomic","nature"],Se=({filteredCats:r,callbackFilter:t})=>e("div",{children:e("div",{className:"catfilters",children:be.map(n=>e("div",{children:s("div",{children:[e("input",{type:"checkbox",id:n,name:n,value:n,onChange:l=>t(l.target.value,l.target.checked)}),e("label",{children:n})]})},n))})});const _e=({duration:r,filterDays:t})=>s("div",{children:[e("p",{className:"daytitle",children:"Duration (max days)"}),e(D,{children:e("input",{onChange:n=>t(n.target.value),className:"duration",type:"number",name:"duration",min:"0",value:r})})]}),xe=({trips:r})=>{const[t,n]=c.exports.useState(""),[l,o]=c.exports.useState(r),[a,i]=c.exports.useState([]),[u,g]=c.exports.useState("");if(!r)return e("div",{children:"Loading"});const[h,y]=c.exports.useState(!1),v=()=>{y(!h)},F=(f,N)=>{i(N?[...a,f]:a.filter(C=>C!==f))};return c.exports.useEffect(()=>{l.map(f=>{console.log(f.days.length<=u)})},[u]),c.exports.useEffect(()=>{let f,N,C;t!==""?(f=r.filter(m=>m.location.toLowerCase().includes(t.toLowerCase())),o(f)):f=r,a.length>0?(N=f.filter(m=>{const d=a.filter(p=>{if(m.categories.includes(p))return m});if(d.length!==0)return d}),f=N,o(N)):o(f),u>0?(C=f.filter(m=>{if(m.days.length<=u)return m}),o(C)):o(f)},[r,t,a,u]),s("div",{className:"tripsbody",children:[e("h3",{className:"pagetitle",children:"Search trips by destination, theme or duration"}),s("div",{className:"searchbar",children:[e(ye,{searchedString:t,callbackSearch:n}),e("button",{className:"toggleBtn",onClick:v,children:e(b,{icon:te})})]}),h&&s("div",{className:"filters",children:[e(Se,{filteredCats:a,callbackFilter:F}),e(_e,{duration:u,filterDays:g})]}),e("p",{className:"instruct",children:"Click on a trip to see the full itinerary"}),e("div",{className:"tripscontainer",children:l.map(f=>e("div",{className:"trip",children:s(B,{to:f._id,children:[s("div",{className:"triptext",children:[e("h3",{className:"title",children:f.title}),e("p",{children:f.description}),s("p",{children:[e(b,{icon:R})," ",f.location]}),e("p",{children:f.categories.join(", ")}),s("p",{children:["Contributor: ",f.author.username]}),s("p",{children:[f.favedBy.length," ",e(b,{icon:M})]})]}),e("img",{src:f.image[0],alt:""}),s("p",{className:"daynumber",children:[e(b,{icon:ne})," DAYS: ",f.days.length]})]})},f._id))})]})},Ne="_container_l800p_1",Ce="_carousel_l800p_9",ke="_buttons_l800p_51",De="_carouselBtns_l800p_61",Fe="_chevron_l800p_61";var L={container:Ne,carousel:Ce,buttons:ke,carouselBtns:De,chevron:Fe};const Le=({trip:r})=>{var o;c.exports.useState(r.image);const t=c.exports.useRef(null),n=a=>{a.preventDefault(),t.current.scrollLeft-=t.current.offsetWidth},l=a=>{a.preventDefault(),t.current.scrollLeft+=t.current.offsetWidth};return console.log("current pic:",t.current),s("div",{children:[e("div",{className:L.container,children:e("div",{className:L.carousel,ref:t,children:(o=r.image)==null?void 0:o.map((a,i)=>e("div",{className:L.image,children:e("img",{src:a,alt:""})},i))})}),s("div",{className:L.carouselBtns,children:[e("button",{className:L.chevron,onClick:n,children:e(b,{icon:re})}),e("button",{className:L.chevron,onClick:l,children:e(b,{icon:ae})})]})]})},we=({id:r})=>{const t={height:"100vh",width:"60%"},[n,l]=c.exports.useState({}),o=i=>{const u={lat:i.coords.latitude,lng:i.coords.longitude};l(u)};c.exports.useEffect(()=>{navigator.geolocation.getCurrentPosition(o)});const a=i=>{const u=i.latLng.lat(),g=i.latLng.lng();l({lat:u,lng:g})};return e(se,{googleMapsApiKey:"AIzaSyDEaeUiFD9oAnB1LNDiK-GWyDq6zS9HWS4",children:e(oe,{mapContainerStyle:t,zoom:13,center:n,children:n.lat?e(ie,{position:n,onDragEnd:i=>a(i),draggable:!0}):null})})},Te="_detailsBody_4yoew_1",Ie="_numberBlock_4yoew_23",Ae="_containerDetails_4yoew_53",Be="_infosBlock_4yoew_71",Ee="_containerWrapper_4yoew_85",Ue="_biggerPic_4yoew_95",Pe="_detailsHeader_4yoew_107",Re="_btn_4yoew_141",$e="_activitiesTitle_4yoew_163",We="_fontIcons_4yoew_173";var x={detailsBody:Te,numberBlock:Ie,containerDetails:Ae,infosBlock:Be,containerWrapper:Ee,biggerPic:Ue,detailsHeader:Pe,btn:Re,activitiesTitle:$e,fontIcons:We};const He=({favesClick:r,faves:t})=>{const[n,l]=c.exports.useState({}),{id:o}=q(),{currentUser:a,isLoggedIn:i,storeToken:u}=P();return c.exports.useEffect(()=>{_.get("http://localhost:8000/trips/"+o).then(({data:g})=>{l(g)}).catch(g=>console.log(g))},[o]),e("div",{className:x.detailsBody,children:n.days?s(D,{children:[s("div",{className:x.detailsHeader,children:[e("h1",{children:n.title}),s("h2",{children:[e(b,{icon:R})," ",n.location]}),e("h3",{children:n.description}),s("h3",{children:["Contributed by: ",n.author.username]})]}),e("div",{}),e("div",{children:e("img",{className:x.biggerPic,src:n.image[0],alt:""})}),s("h3",{children:["Favourited by: ",n.favedBy.length," ",e(b,{className:x.fontIcons,icon:M})]}),i&&s("div",{className:"tripsbtn",children:[!t.includes(o)&&s("button",{onClick:()=>r(o),children:["Favourite"," ",e(b,{className:x.fontIcons,icon:le})]}),t.includes(o)&&s("button",{onClick:()=>r(o),children:["Unfavourite"," ",e(b,{className:x.fontIcons,icon:ce})]})]}),e(B,{to:"/trips",children:e("button",{children:"Back to trips"})}),e("div",{className:x.containerWrapper,children:n.days.map(g=>s("div",{className:x.containerDetails,children:[e("div",{className:x.numberBlock,classkey:g._id,children:e("p",{children:g.number})}),e("div",{className:x.infosBlock,children:g.activities.map(h=>s("div",{children:[e("p",{className:x.activitiesTitle,children:h.title}),s("p",{children:[s("b",{children:[e(b,{className:x.fontIcons,icon:R})," "]}),h.address]}),s("p",{children:[s("b",{children:[e(b,{className:x.fontIcons,icon:de})," "]}),h.description]}),e("br",{})]},h._id))})]},g._id))}),e(Le,{trip:n}),e(we,{id:o})]}):e("p",{children:"Sorry, no trip yet!"})})},G=r=>{const[t,n]=c.exports.useState(r);return[t,o=>{n(I(T({},t),{[o.target.name]:o.target.value}))}]},je=()=>{const[r,t]=G({email:"",password:""}),[n,l]=c.exports.useState(null),o=E(),{authenticateUser:a,storeToken:i}=P(),u=g=>{g.preventDefault(),_.signin(r).then(h=>{console.log("this is signin front:",h),i(h.authToken),a(),o("/")}).catch(h=>{console.error(h),l(h.response)})};return s(D,{children:[n&&e("h3",{className:"error",children:n.message}),s("form",{className:"authform",onSubmit:u,children:[e("h2",{children:"Sign in"}),e("label",{htmlFor:"email",children:"Email"}),e("input",{type:"email",id:"email",name:"email",onChange:t,value:r.email}),e("label",{htmlFor:"password",children:"Password"}),e("input",{type:"password",id:"password",name:"password",onChange:t,value:r.password}),e("button",{children:"Sign in"})]})]})};const Oe=()=>e("div",{className:"signinbody",children:e(je,{})}),Me=()=>{const[r,t]=G({name:"",username:"",email:"",password:""}),[n,l]=c.exports.useState(null),o=E(),a=i=>{i.preventDefault(),_.signup(r).then(u=>{console.log("this is signup front:",u),o("/signin")}).catch(u=>{l(u.response.data)})};return s(D,{children:[n&&e("h3",{className:"error",children:n.message}),s("form",{className:"authform",onSubmit:a,children:[e("h2",{children:"Sign up"}),e("label",{htmlFor:"name",children:"Name"}),e("input",{onChange:t,value:r.name,type:"text",id:"name",name:"name"}),e("label",{htmlFor:"username",children:"Username"}),e("input",{onChange:t,value:r.username,type:"text",id:"username",name:"username"}),e("label",{htmlFor:"email",children:"Email"}),e("input",{onChange:t,value:r.email,type:"email",id:"email",name:"email"}),e("label",{htmlFor:"password",children:"Password"}),e("input",{onChange:t,value:r.password,type:"password",id:"password",name:"password"}),e("button",{children:"Create account"})]})]})},qe=()=>e("div",{className:"signupbody",children:e(Me,{})}),ze="_profileWrapper_1pl6g_3",Ye="_profileSection_1pl6g_45",Ge="_addTripContainer_1pl6g_65",Ke="_createtrip_1pl6g_95",Ve="_plusIcon_1pl6g_127",Je="_favoritesProfile_1pl6g_141",Qe="_favtrips_1pl6g_157",Xe="_proftrip_1pl6g_183",Ze="_proftriptitle_1pl6g_215",et="_profbuttons_1pl6g_239";var S={profileWrapper:ze,profileSection:Ye,addTripContainer:Ge,createtrip:Ke,plusIcon:Ve,favoritesProfile:Je,favtrips:Qe,proftrip:Xe,proftriptitle:Ze,profbuttons:et};const tt=()=>{P();const[r,t]=c.exports.useState([]),[n,l]=c.exports.useState([]);c.exports.useEffect(()=>{_.get("/users/profile/faves").then(({data:a})=>{t(a.favourites)}).catch(a=>console.error(a))},[]),c.exports.useEffect(()=>{_.get("/users/profile/added").then(({data:a})=>{l(a)}).catch(a=>console.error(a))},[]);const o=async a=>{try{await _.delete(`/trips/${a}/delete`),_.get("/users/profile/added").then(({data:i})=>{l(i)}).catch(i=>console.error(i))}catch(i){console.error(i)}};return e("div",{className:S.profileWrapper,children:s("div",{className:S.profileSection,children:[e("section",{className:S.addTripContainer,children:e("div",{className:S.createtrip,children:s(B,{to:"/profile/create",children:[e("h2",{children:"Let others discover your trips!"}),e(D,{children:e(b,{icon:ue,className:S.plusIcon})}),e("h2",{children:"Create itinerary"})]})})}),e("h2",{children:"Your favourite itineraries"}),e("section",{className:S.favoritesProfile,children:e("div",{className:S.favtrips,children:r.map(a=>s("div",{className:S.proftrip,children:[e("p",{className:S.proftriptitle,children:a.title}),e("p",{children:a.description}),s("p",{children:[e(b,{icon:R})," ",a.location]}),e("img",{src:a==null?void 0:a.image[0],alt:""}),e(B,{to:`/trips/${a._id}`,children:e("button",{children:"See full itinerary"})})]},a._id))})}),e("h2",{children:"Your added trips"}),e("section",{className:S.favoritesProfile,children:e("div",{className:S.favtrips,children:n.map(a=>s("div",{className:S.proftrip,children:[e("p",{className:S.proftriptitle,children:a.title}),e("p",{children:a.description}),s("p",{children:[e("i",{className:"fas fa-map-marker-alt"})," ",a.location]}),e("img",{src:a==null?void 0:a.image[0],alt:""}),s("div",{className:S.profbuttons,children:[e("a",{href:`/profile/${a._id}/update`,children:e("i",{className:"fa-solid fa-pen"})}),e(B,{to:`/trips/${a._id}`,children:e("button",{children:"See full itinerary"})}),e("a",{onClick:()=>o(a._id),children:e("i",{className:"fa-solid fa-trash-can"})})]})]},a._id))})})]})})};let H;const nt=(r,t)=>{let n=document.createElement("script");n.type="text/javascript",n.readyState?n.onreadystatechange=function(){(n.readyState==="loaded"||n.readyState==="complete")&&(n.onreadystatechange=null,t())}:n.onload=()=>t(),n.src=r,document.getElementsByTagName("head")[0].appendChild(n)};function rt(r,t){H=new window.google.maps.places.Autocomplete(t.current),H.addListener("place_changed",()=>at(r))}async function at(r){const t=H.getPlace(),{lat:n,lng:l}=t.geometry.location;r({name:"address",value:t.formatted_address,address:t.formatted_address,coords:{coordinates:[n(),l()]}}),console.log("addressObject",t)}function st({address:r,activityChange:t,activityNumber:n}){const[l,o]=c.exports.useState(r),a=c.exports.useRef(null);c.exports.useEffect(()=>{nt("https://maps.googleapis.com/maps/api/js?key=AIzaSyDEaeUiFD9oAnB1LNDiK-GWyDq6zS9HWS4&libraries=places",()=>rt(o,a))},[]),c.exports.useEffect(()=>{console.log("~query changed"),t({target:l})},[l]);const i=u=>{};return s("div",{className:"search-location-input",children:[e("label",{htmlFor:"address-"+n,children:"Address"}),e("input",{type:"text",name:"address",id:"address-"+n,ref:a,onChange:i,placeholder:""})]})}const ot=({activity:r,setDays:t,activityNumber:n,dayNumber:l,update:o})=>{const a=i=>{console.log(i.target,"<<< ici"),t(u=>{const g=[...u];return o?g[l].activities[n]=I(T({},g[l].activities[n]),{[i.target.name]:i.target.value}):g[l][n]=I(T({},g[l][n]),{[i.target.name]:i.target.value}),g})};return s("div",{className:"crudform",children:[s("div",{children:[e("label",{htmlFor:"activityTitle-"+n,children:"Title"}),e("input",{type:"text",name:"title",id:`activityTitle-${n}`,className:"crud-long-input",value:r.title,onChange:a})]}),e("div",{children:e(st,{address:r.address,activityNumber:n,activityChange:a})}),s("div",{children:[e("label",{htmlFor:"activityDescription-"+n,children:"Description"}),e("input",{type:"text",name:"description",className:"crud-long-input",value:r.description,onChange:a})]})]})},K=({dayNumber:r,activities:t,setDays:n,update:l})=>{console.log("It's a brand new day !");const o=a=>{a.preventDefault(),n(i=>{const u=[...i];return l?u[r].activities=[...u[r].activities,{title:"",address:"",description:""}]:u[r]=[...u[r],{title:"",address:"",description:""}],u})};return console.log("Activities :",t),t?s("div",{className:"crudform",children:[s("div",{className:"activitycount",children:[s("h2",{children:["Day n\xB0 ",r+1]}),s("h3",{children:[e("i",{class:"fa-solid fa-person-snowboarding"})," ACTIVITIES:"," ",t.length," "]})]}),t.map((a,i)=>e(ot,{activity:a,dayNumber:r,activityNumber:i,setDays:n,update:l},i)),s("button",{onClick:o,className:"activitybutton",children:["ADD ACTIVITY ",e("i",{class:"fa-solid fa-plus"})]})]}):null};const it=()=>{const[r,t]=c.exports.useState(""),[n,l]=c.exports.useState([]),[o,a]=c.exports.useState(""),[i,u]=c.exports.useState(""),g=c.exports.useRef(),[h,y]=c.exports.useState([[{title:"",address:"",description:""}]]),v=E(),F=["budget","comfortable","luxury","family","adventure","culture","shopping","romantic","party","gastronomic","nature"],f=m=>{m.preventDefault(),y(d=>[...d,[{title:"",address:"",description:""}]])},N=m=>{if(m.target.checked)l([...n,m.target.value]);else{const d=n.filter(p=>p!==m.target.value);l(d)}},C=m=>{m.preventDefault();const d=new FormData;d.append("title",r),d.append("categories",n),d.append("location",o),d.append("description",i),d.append("image",g.current.files[0]),d.append("days",JSON.stringify(h)),console.log("FORM DATA ------>",d),console.log("---> What are you 'days' ?",h),_.post("/trips",d).then(p=>{console.log("RES apiHandler",p),v("/profile")}).catch(p=>console.log(p))};return console.log("------- CURRENT STATE OF TRIP IS -----"),s("div",{className:"crudbody",children:[e("h2",{children:"Create a travel itinerary"}),e("div",{className:"maintripform",children:s("form",{className:"crudform",onSubmit:C,children:[s("div",{children:[e("label",{htmlFor:"title",children:" Title "}),e("input",{type:"text",id:"title",className:"crud-long-input",value:r,onChange:m=>t(m.target.value)})]}),s("div",{children:[e("label",{htmlFor:"location",children:" Location "}),e("input",{type:"text",id:"location",className:"crud-long-input",value:o,onChange:m=>a(m.target.value)})]}),e("div",{className:"crud-cats",children:F.map((m,d)=>s(z.Fragment,{children:[e("input",{type:"checkbox",id:`category-${m}-${d}`,value:m,onChange:N}),e("label",{htmlFor:`category-${m}-${d}`,children:m})]},d))}),s("div",{children:[e("label",{htmlFor:"description",children:" Description "}),e("input",{type:"text",id:"description",className:"crud-long-input",value:i,onChange:m=>u(m.target.value)})]}),e("p",{children:"Upload a picture from your trip:"}),e("input",{ref:g,name:"image",type:"file"}),s("h3",{className:"daycount",children:[e("i",{className:"far fa-calendar-alt"})," DAYS: ",h==null?void 0:h.length]}),s("button",{onClick:f,children:["ADD DAY ",e("i",{className:"fa-solid fa-plus"})]}),h.map((m,d)=>e(K,{activities:h[d],setDays:y,dayNumber:d},d)),e("div",{className:"crud-submit",children:e("button",{onClick:C,children:"Good"})})]})})]})};function lt(){const r=E(),t=q(),[n,l]=c.exports.useState(""),[o,a]=c.exports.useState([]),[i,u]=c.exports.useState(""),[g,h]=c.exports.useState(""),y=c.exports.useRef(),[v,F]=c.exports.useState(null),f=["budget","comfortable","luxury","family","adventure","culture","shopping","romantic","party","gastronomic","nature"];c.exports.useEffect(()=>{(async()=>{const{data:p}=await _.get("/trips/"+t.id);console.log(p),l(p.title),a(p.categories),u(p.location),h(p.description),F(p.days)})()},[t.id]);const N=d=>{d.preventDefault(),F(p=>[...p,{activities:[{title:"",address:"",description:""}],number:p.length+1}])},C=d=>{if(d.target.checked)a([...o,d.target.value]);else{const p=o.filter(w=>w!==d.target.value);a(p)}},m=async d=>{console.log("i am in handle submit"),d.preventDefault();const p=new FormData;p.append("title",n),p.append("categories",o),p.append("location",i),p.append("description",g),p.append("image",y.current.files[0]),p.append("days",JSON.stringify(v));try{const{data:w}=await _.patch("/trips/"+t.id,p);console.log("data updated :",w),r("/profile")}catch(w){console.log(w)}};return v?e(D,{children:s("div",{children:[e("h2",{children:"UPDATE YOUR TRIP"}),s("form",{className:"tripform",onSubmit:m,children:[s("div",{children:[e("label",{htmlFor:"title",children:" Title "}),e("input",{type:"text",id:"title",value:n,onChange:d=>l(d.target.value)})]}),s("div",{children:[e("label",{htmlFor:"location",children:" Location "}),e("input",{type:"text",id:"location",value:i,onChange:d=>u(d.target.value)})]}),e("div",{children:f.map((d,p)=>s(z.Fragment,{children:[e("input",{type:"checkbox",id:`category-${d}-${p}`,value:d,onChange:C}),e("label",{htmlFor:`category-${d}-${p}`,children:d})]},p))}),s("div",{children:[e("label",{htmlFor:"description",children:" Description "}),e("input",{type:"text",id:"description",value:g,onChange:d=>h(d.target.value)})]}),e("input",{ref:y,name:"image",type:"file"}),e("button",{onClick:N,children:"Add a day"}),s("p",{children:["Number of days ",v==null?void 0:v.length," "]}),v.map((d,p)=>e(K,{activities:v[p].activities,setDays:F,dayNumber:p,update:!0},p)),e("button",{onClick:m,children:"Good"})]})]})}):e("p",{children:"Loading"})}function ct(){const[r,t]=c.exports.useState([]),[n,l]=c.exports.useState([]),[o,a]=c.exports.useState([]),{currentUser:i,isLoggedIn:u,storeToken:g}=P();return c.exports.useEffect(()=>{_.get("/trips").then(({data:y})=>{t(y)}).catch(y=>console.error(y))},[]),c.exports.useEffect(()=>{i&&l(i.favourites)},[u]),s("div",{className:"App",children:[e(ve,{}),s(pe,{children:[e(k,{path:"/",element:e(fe,{trips:r})}),e(k,{path:"/trips",element:e(xe,{trips:r})}),e(k,{path:"/trips/:id",element:e(He,{trips:r,favesClick:y=>{_.patch("/users/favourites/"+y).then(({data:v})=>{l(v.updatedUser.favourites),a(v.updatedTrip.favedBy),console.log("all data",v)}).catch(v=>console.error(v))},faves:n})}),e(k,{path:"/signup",element:e(qe,{})}),e(k,{path:"/signin",element:e(Oe,{})}),e(k,{path:"/profile",element:e(tt,{faves:n})}),e(k,{path:"/profile/create",element:e(it,{})}),e(k,{path:"/profile/:id/update",element:e(lt,{})})]})]})}const dt=({children:r})=>{const t=E(),[n,l]=c.exports.useState({currentUser:null,isLoading:!0,isLoggedIn:!1});c.exports.useEffect(()=>{o()},[]);const o=()=>{const h=localStorage.getItem("authToken");h?_.isLoggedIn(h).then(y=>{l({currentUser:y,isLoading:!1,isLoggedIn:!0})}).catch(y=>{l({currentUser:null,isLoading:!1,isLoggedIn:!1})}):l({currentUser:null,isLoading:!1,isLoggedIn:!1})},a=()=>{i(),o(),t("/")},i=()=>{localStorage.removeItem("authToken")},u=h=>{localStorage.setItem("authToken",h),o()},g={currentUser:n.currentUser,isLoading:n.isLoading,isLoggedIn:n.isLoggedIn,removeUser:a,storeToken:u,authenticateUser:o};return e(Y.Provider,{value:g,children:r})};he.render(e(me,{children:e(dt,{children:e(ct,{})})}),document.getElementById("root"));
